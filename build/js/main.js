"use strict";

var playBtn = document.querySelector('.bonus__main-wheel-btn'),
  main = document.querySelector('.bonus__main'),
  wheel = document.querySelector('.bonus__main-wheel-reel'),
  overlay = document.querySelector('.bonus__overlay'),
  popupFirst = document.querySelector('.bonus__firstWin'),
  popupFirstBtn = document.querySelector('.bonus__firstWin-btn'),
  popupSecond = document.querySelector('.bonus__secondWin'),
  overflow = document.querySelector('body'),
  wrapper = document.querySelector('.bonus'),
  bubbleText = document.querySelector('.bonus__main-bubble');
var triesCounter = 0;
var babbleTextAfterRotation = 'Маeш одну спробу, смертний';
playBtn.addEventListener('click', function () {
  if (triesCounter === 0) {
    runFirstRotation();
  } else {
    runSecondRotation();
  }
});
function runFirstRotation() {
  wheel.classList.add('reel-rotation-first');
  playBtn.classList.remove('pulse-btn');
  playBtn.style.cursor = 'default';
  wrapper.style.pointerEvents = 'none';
  setTimeout(function () {
    doAfterFirstRotation();
  }, 6000);
  triesCounter++;
}
function doAfterFirstRotation() {
  bubbleText.innerHTML = babbleTextAfterRotation;
  wheel.style.transform = 'rotate(992deg)';
  wheel.classList.remove('reel-rotation-first');
  displayPopup(popupFirst);
  wrapper.style.pointerEvents = 'auto';
  overflow.style.overflow = 'hidden';
  setTimeout(function () {
    playBtn.classList.add('pulse-btn');
    playBtn.style.cursor = 'pointer';
  }, 1200);
}
function runSecondRotation() {
  wheel.classList.add('reel-rotation-second');
  playBtn.classList.remove('pulse-btn');
  playBtn.style.cursor = 'default';
  overflow.style.overflow = 'hidden';
  wrapper.style.pointerEvents = 'none';
  setTimeout(function () {
    doAfterSecondRotation();
  }, 6000);
  triesCounter++;
}
function doAfterSecondRotation() {
  displayPopup(popupSecond);
  wrapper.style.pointerEvents = 'auto';
}
popupFirstBtn.addEventListener('click', function () {
  overlay.classList.add('opacity-overlay');
  popupFirst.classList.add('hide');
  overflow.style.overflow = 'unset';
});
function displayPopup(popup) {
  overlay.classList.remove('opacity-overlay');
  popup.classList.remove('hide');
}
window.addEventListener('orientationchange', function () {
  window.location.reload();
  // const orientation = window.matchMedia('(orientation: landscape)')
  //
  // if (orientation.matches) {
  //     window.location.reload()
  // }
});

(function () {
  var url = new URL(window.location.href);
  var params = ['l', 'utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content', 'param1', 'param2'];
  var linkParams = ['affid', 'cpaid']; // ищем в url redirectUrl в url:

  if (url.searchParams.has('redirectUrl')) {
    var redirectUrl = new URL(url.searchParams.get('redirectUrl'));
    if (redirectUrl.href.match(/\//g).length === 4 && redirectUrl.searchParams.get('l')) {
      //если ссылка в ссылка redirectUrl корректная
      localStorage.setItem('redirectUrl', redirectUrl.href); // указываем точкой входа домен с протоколом из redirectUrl
    }
  } /////////

  params.forEach(function (param) {
    if (url.searchParams.has(param)) localStorage.setItem(param, url.searchParams.get(param));
  });
  linkParams.forEach(function (linkParam) {
    if (url.searchParams.has(linkParam)) localStorage.setItem(linkParam, url.searchParams.get(linkParam));
  });
  window.addEventListener('click', function (e) {
    var link,
      parent = e.target.closest('a');
    if (parent.getAttribute('href') !== 'https://tds.favbet.partners') {
      return;
    }
    parent && (e.preventDefault(), localStorage.getItem("redirectUrl") ? link = new URL(localStorage.getItem("redirectUrl")) : (link = new URL(parent.href), affid = localStorage.getItem('affid'), cpaid = localStorage.getItem('cpaid'), affid && cpaid && (link.pathname = '/' + affid + '/' + cpaid)), params.forEach(function (param) {
      url.searchParams.has(param) && link.searchParams.set(param, localStorage.getItem(param));
    }), document.location.href = link);
  });
})();
"use strict";
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsicGxheUJ0biIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1haW4iLCJ3aGVlbCIsIm92ZXJsYXkiLCJwb3B1cEZpcnN0IiwicG9wdXBGaXJzdEJ0biIsInBvcHVwU2Vjb25kIiwib3ZlcmZsb3ciLCJ3cmFwcGVyIiwiYnViYmxlVGV4dCIsInRyaWVzQ291bnRlciIsImJhYmJsZVRleHRBZnRlclJvdGF0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJ1bkZpcnN0Um90YXRpb24iLCJydW5TZWNvbmRSb3RhdGlvbiIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInN0eWxlIiwiY3Vyc29yIiwicG9pbnRlckV2ZW50cyIsInNldFRpbWVvdXQiLCJkb0FmdGVyRmlyc3RSb3RhdGlvbiIsImlubmVySFRNTCIsInRyYW5zZm9ybSIsImRpc3BsYXlQb3B1cCIsImRvQWZ0ZXJTZWNvbmRSb3RhdGlvbiIsInBvcHVwIiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJ1cmwiLCJVUkwiLCJocmVmIiwicGFyYW1zIiwibGlua1BhcmFtcyIsInNlYXJjaFBhcmFtcyIsImhhcyIsInJlZGlyZWN0VXJsIiwiZ2V0IiwibWF0Y2giLCJsZW5ndGgiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiZm9yRWFjaCIsInBhcmFtIiwibGlua1BhcmFtIiwiZSIsImxpbmsiLCJwYXJlbnQiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiZ2V0QXR0cmlidXRlIiwicHJldmVudERlZmF1bHQiLCJnZXRJdGVtIiwiYWZmaWQiLCJjcGFpZCIsInBhdGhuYW1lIiwic2V0Il0sIm1hcHBpbmdzIjoiOztBQUNBLElBQU1BLE9BQU8sR0FBR0MsUUFBUSxDQUFDQyxhQUFhLENBQUMsd0JBQXdCLENBQUM7RUFDMURDLElBQUksR0FBR0YsUUFBUSxDQUFDQyxhQUFhLENBQUMsY0FBYyxDQUFDO0VBQzdDRSxLQUFLLEdBQUdILFFBQVEs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QUM3Qk4sSUFBSSxHQUFHLElBQUloQixHQUFHLENBQUNVLFlBQVksQ0FBQ1ksT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQ2xETixJQUFJLEdBQUcsSUFBSWhCLEdBQUcsQ0FBQ2lCLE1BQU0sQ0FBQ2hCLElBQUksQ0FBQyxFQUMxQnNCLEtBQUssR0FBR2IsWUFBWSxDQUFDWSxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQ3JDRSxLQUFLLEdBQUdkLFlBQVksQ0FBQ1ksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUN6Q0MsS0FBSyxJQUFJQyxLQUFLLEtBQUtSLElBQUksQ0FBQ1MsUUFBUSxHQUFHLEdBQUcsR0FBR0YsS0FBSyxHQUFHLEdBQUcsR0FBR0MsS0FBSyxDQUFDLENBQUMsRUFBRXRCLE1BQU0sQ0FBQ1UsT0FBTyxDQUFDLFVBQVVDLEtBQUssRUFDdEc7TUFDSWQsR0FBRyxDQUFDSyxZQUFZLENBQUNDLEdBQUcsQ0FBQ1EsS0FBSyxDQUFDLElBQUlHLElBQUksQ0FBQ1osWUFBWSxDQUFDc0IsR0FBRyxDQUFDYixLQUFLLEVBQUVILFlBQVksQ0FBQ1ksT0FBTyxDQUFDVCxLQUFLLENBQUMsQ0FBQztJQUM1RixDQUFDLENBQUMsRUFBRTlDLFFBQVEsQ0FBQzhCLFFBQVEsQ0FBQ0ksSUFBSSxHQUFHZSxJQUFJLENBQUM7RUFDdEMsQ0FBQyxDQUFDO0FBQ04sQ0FBQyxFQUFFLENBQUM7QUNsSUoiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fbWFpbi13aGVlbC1idG4nKSxcbiAgICAgIG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX21haW4nKSxcbiAgICAgIHdoZWVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19tYWluLXdoZWVsLXJlZWwnKSxcbiAgICAgIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX292ZXJsYXknKSxcbiAgICAgIHBvcHVwRmlyc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX2ZpcnN0V2luJyksXG4gICAgICBwb3B1cEZpcnN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19maXJzdFdpbi1idG4nKSxcbiAgICAgIHBvcHVwU2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19zZWNvbmRXaW4nKSxcbiAgICAgIG92ZXJmbG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgICAgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251cycpLFxuICAgICAgYnViYmxlVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fbWFpbi1idWJibGUnKVxuXG5cbmxldCB0cmllc0NvdW50ZXIgPSAwXG5sZXQgYmFiYmxlVGV4dEFmdGVyUm90YXRpb24gPSAn0JzQsGXRiCDQvtC00L3RgyDRgdC/0YDQvtCx0YMsINGB0LzQtdGA0YLQvdC40LknXG5cbnBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYgKHRyaWVzQ291bnRlciA9PT0gMCkge1xuICAgICAgICBydW5GaXJzdFJvdGF0aW9uKClcbiAgICB9IGVsc2Uge1xuICAgICAgICBydW5TZWNvbmRSb3RhdGlvbigpXG4gICAgfVxufSlcblxuZnVuY3Rpb24gcnVuRmlyc3RSb3RhdGlvbigpIHtcbiAgICB3aGVlbC5jbGFzc0xpc3QuYWRkKCdyZWVsLXJvdGF0aW9uLWZpcnN0JylcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3B1bHNlLWJ0bicpXG4gICAgcGxheUJ0bi5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCdcbiAgICB3cmFwcGVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSdcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBkb0FmdGVyRmlyc3RSb3RhdGlvbigpXG4gICAgfSwgNjAwMClcbiAgICB0cmllc0NvdW50ZXIrK1xufVxuXG5mdW5jdGlvbiBkb0FmdGVyRmlyc3RSb3RhdGlvbigpIHtcbiAgICBidWJibGVUZXh0LmlubmVySFRNTCAgPSBiYWJibGVUZXh0QWZ0ZXJSb3RhdGlvbjtcbiAgICB3aGVlbC5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDk5MmRlZyknXG4gICAgd2hlZWwuY2xhc3NMaXN0LnJlbW92ZSgncmVlbC1yb3RhdGlvbi1maXJzdCcpXG4gICAgZGlzcGxheVBvcHVwKHBvcHVwRmlyc3QpXG4gICAgd3JhcHBlci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nXG4gICAgb3ZlcmZsb3cuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJ1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBwbGF5QnRuLmNsYXNzTGlzdC5hZGQoJ3B1bHNlLWJ0bicpXG4gICAgICAgIHBsYXlCdG4uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInXG4gICAgfSwgMTIwMClcbn1cblxuZnVuY3Rpb24gcnVuU2Vjb25kUm90YXRpb24oKSB7XG4gICAgd2hlZWwuY2xhc3NMaXN0LmFkZCgncmVlbC1yb3RhdGlvbi1zZWNvbmQnKVxuICAgIHBsYXlCdG4uY2xhc3NMaXN0LnJlbW92ZSgncHVsc2UtYnRuJylcbiAgICBwbGF5QnRuLnN0eWxlLmN1cnNvciA9ICdkZWZhdWx0J1xuICAgIG92ZXJmbG93LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbidcbiAgICB3cmFwcGVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSdcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZG9BZnRlclNlY29uZFJvdGF0aW9uKClcbiAgICB9LCA2MDAwKVxuICAgIHRyaWVzQ291bnRlcisrXG59XG5cbmZ1bmN0aW9uIGRvQWZ0ZXJTZWNvbmRSb3RhdGlvbigpIHtcbiAgICBkaXNwbGF5UG9wdXAocG9wdXBTZWNvbmQpXG4gICAgd3JhcHBlci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nXG59XG5cblxucG9wdXBGaXJzdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ29wYWNpdHktb3ZlcmxheScpXG4gICAgcG9wdXBGaXJzdC5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICBvdmVyZmxvdy5zdHlsZS5vdmVyZmxvdyA9ICd1bnNldCdcblxufSlcblxuZnVuY3Rpb24gZGlzcGxheVBvcHVwKHBvcHVwKSB7XG4gICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdvcGFjaXR5LW92ZXJsYXknKVxuICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuXG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsICgpID0+IHtcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbiAgICAvLyBjb25zdCBvcmllbnRhdGlvbiA9IHdpbmRvdy5tYXRjaE1lZGlhKCcob3JpZW50YXRpb246IGxhbmRzY2FwZSknKVxuICAgIC8vXG4gICAgLy8gaWYgKG9yaWVudGF0aW9uLm1hdGNoZXMpIHtcbiAgICAvLyAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG4gICAgLy8gfVxufSk7XG5cblxuKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgdmFyIHBhcmFtcyA9IFsnbCcsICd1dG1fc291cmNlJywgJ3V0bV9tZWRpdW0nLCAndXRtX2NhbXBhaWduJywgJ3V0bV90ZXJtJywgJ3V0bV9jb250ZW50JywgJ3BhcmFtMScsICdwYXJhbTInXTtcbiAgICB2YXIgbGlua1BhcmFtcyA9IFsnYWZmaWQnLCAnY3BhaWQnXTsgLy8g0LjRidC10Lwg0LIgdXJsIHJlZGlyZWN0VXJsINCyIHVybDpcblxuICAgIGlmICh1cmwuc2VhcmNoUGFyYW1zLmhhcygncmVkaXJlY3RVcmwnKSkge1xuICAgICAgICB2YXIgcmVkaXJlY3RVcmwgPSBuZXcgVVJMKHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdyZWRpcmVjdFVybCcpKTtcblxuICAgICAgICBpZiAocmVkaXJlY3RVcmwuaHJlZi5tYXRjaCgvXFwvL2cpLmxlbmd0aCA9PT0gNCAmJiByZWRpcmVjdFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsJykpIHtcbiAgICAgICAgICAgIC8v0LXRgdC70Lgg0YHRgdGL0LvQutCwINCyINGB0YHRi9C70LrQsCByZWRpcmVjdFVybCDQutC+0YDRgNC10LrRgtC90LDRj1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JlZGlyZWN0VXJsJywgcmVkaXJlY3RVcmwuaHJlZik7IC8vINGD0LrQsNC30YvQstCw0LXQvCDRgtC+0YfQutC+0Lkg0LLRhdC+0LTQsCDQtNC+0LzQtdC9INGBINC/0YDQvtGC0L7QutC+0LvQvtC8INC40LcgcmVkaXJlY3RVcmxcbiAgICAgICAgfVxuICAgIH0gLy8vLy8vLy8vXG5cblxuICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICBpZiAodXJsLnNlYXJjaFBhcmFtcy5oYXMocGFyYW0pKSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShwYXJhbSwgdXJsLnNlYXJjaFBhcmFtcy5nZXQocGFyYW0pKTtcbiAgICB9KTtcbiAgICBsaW5rUGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKGxpbmtQYXJhbSkge1xuICAgICAgICBpZiAodXJsLnNlYXJjaFBhcmFtcy5oYXMobGlua1BhcmFtKSkgbG9jYWxTdG9yYWdlLnNldEl0ZW0obGlua1BhcmFtLCB1cmwuc2VhcmNoUGFyYW1zLmdldChsaW5rUGFyYW0pKTtcbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgbGluayxcbiAgICAgICAgICAgIHBhcmVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2EnKTtcblxuICAgICAgICBpZiAocGFyZW50LmdldEF0dHJpYnV0ZSgnaHJlZicpICE9PSAnaHR0cHM6Ly90ZHMuZmF2YmV0LnBhcnRuZXJzJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcGFyZW50ICYmIChlLnByZXZlbnREZWZhdWx0KCksXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInJlZGlyZWN0VXJsXCIpXG4gICAgICAgICAgICAgICAgPyBsaW5rID0gbmV3IFVSTChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInJlZGlyZWN0VXJsXCIpKVxuICAgICAgICAgICAgICAgIDogKGxpbmsgPSBuZXcgVVJMKHBhcmVudC5ocmVmKSxcbiAgICAgICAgICAgICAgICAgICAgYWZmaWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWZmaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgY3BhaWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3BhaWQnKSxcbiAgICAgICAgICAgICAgICBhZmZpZCAmJiBjcGFpZCAmJiAobGluay5wYXRobmFtZSA9ICcvJyArIGFmZmlkICsgJy8nICsgY3BhaWQpKSwgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKVxuICAgICAgICB7XG4gICAgICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLmhhcyhwYXJhbSkgJiYgbGluay5zZWFyY2hQYXJhbXMuc2V0KHBhcmFtLCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShwYXJhbSkpO1xuICAgICAgICB9KSwgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGxpbmspO1xuICAgIH0pO1xufSkoKTtcblxuXG4iLCIiXX0=
