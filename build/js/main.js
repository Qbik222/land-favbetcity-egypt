"use strict";

var playBtn = document.querySelector('.bonus__main-wheel-btn'),
  main = document.querySelector('.bonus__main'),
  wheel = document.querySelector('.bonus__main-wheel-reel'),
  overlay = document.querySelector('.bonus__overlay'),
  popupFirst = document.querySelector('.bonus__firstWin'),
  popupFirstBtn = document.querySelector('.bonus__firstWin-btn'),
  popupSecond = document.querySelector('.bonus__secondWin'),
  overflow = document.querySelector('body'),
  wrapper = document.querySelector('.bonus'),
  copyBtn = document.querySelector('.bonus__secondWin-code-btn'),
  bonusStart = document.querySelector('.bonus__start'),
  bonusText = document.querySelector('.bonus__text'),
  audioCoin = document.querySelector('.audio-coins'),
  audioFirework = document.querySelector('.audio-firework'),
  audioMain = document.querySelector('.audio-main'),
  audioWheel = document.querySelector('.audio-wheel'),
  btnVolume = document.querySelector('.bonus__music'),
  btnVolumeImg = document.querySelector('.bonus__music-img'),
  body = document.querySelector('body');
audioMain.volume = 0.35;
audioFirework.volume = 0.6;
audioCoin.volume = 0.6;
function scrollToTop() {
  var currentPosition = document.documentElement.scrollTop || document.body.scrollTop;
  if (currentPosition > 0) {
    window.requestAnimationFrame(scrollToTop);
    window.scrollTo(0, currentPosition - currentPosition / 8);
  }
}
btnVolume.addEventListener('click', function () {
  if (btnVolume.classList.contains('off')) {
    btnVolume.classList.remove('off');
    btnVolume.classList.add('on');
    audioMain.play();
    audioFirework.play();
    btnVolumeImg.setAttribute('src', 'img/sound-on.svg');
  } else {
    btnVolume.classList.remove('on');
    btnVolume.classList.add('off');
    audioMain.pause();
    audioMain.currentTime = 0;
    audioFirework.pause();
    audioFirework.currentTime = 0;
    audioWheel.pause();
    audioWheel.currentTime = 0;
    audioCoin.pause();
    audioCoin.currentTime = 0;
    btnVolumeImg.setAttribute('src', 'img/sound-off.svg');
  }
});
setTimeout(function () {
  bonusStart.classList.add('_active');
  main.classList.add('_active');
  setTimeout(function () {
    bonusText.classList.add('_visible');
  }, 1200);
}, 3500);
copyBtn.addEventListener('click', function () {
  copyBtn.classList.add('_copy');
  setTimeout(function () {
    copyBtn.classList.remove('_copy');
  }, 2000);
  var textToCopy = "egyptsem";
  // Копируем текст в буфер обмена
  navigator.clipboard.writeText(textToCopy).then(function () {
    console.log('copy code');
  })["catch"](function (error) {
    console.error('error', error);
  });
});
playBtn.addEventListener('click', function () {
  runFirstRotation();
});
function runFirstRotation() {
  scrollToTop();
  btnVolume.classList.remove('off');
  btnVolume.classList.add('on');
  btnVolumeImg.setAttribute('src', 'img/sound-on.svg');
  audioMain.play();
  audioFirework.play();
  audioWheel.play();
  wheel.classList.add('reel-rotation-first');
  playBtn.classList.remove('pulse-btn');
  playBtn.style.cursor = 'default';
  wrapper.style.pointerEvents = 'none';
  wrapper.style.overflow = 'hidden';
  body.style.overflow = 'hidden';
  setTimeout(function () {
    doAfterFirstRotation();
  }, 6000);
}
function doAfterFirstRotation() {
  audioCoin.play();
  wheel.style.transform = 'rotate(1440deg)';
  wheel.classList.remove('reel-rotation-first');
  displayPopup(popupFirst);
  wrapper.style.pointerEvents = 'auto';
  overflow.style.overflow = 'hidden';
}
popupFirstBtn.addEventListener('click', function () {
  popupFirst.classList.add('_opacity');
  popupSecond.classList.remove('_opacity');
});
function displayPopup(popup) {
  overlay.classList.remove('opacity-overlay');
  popup.classList.remove('hide');
}
window.addEventListener('orientationchange', function () {
  window.location.reload();
});
(function () {
  var url = new URL(window.location.href);
  var params = ['l', 'utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content', 'param1', 'param2', 'param3', 'param4', 'creative_type', 'creative_id'];
  var linkParams = ['affid', 'cpaid']; // ищем в url redirectUrl в url:

  if (url.searchParams.has('redirectUrl')) {
    var redirectUrl = new URL(url.searchParams.get('redirectUrl'));
    if (redirectUrl.href.match(/\//g).length === 4 && redirectUrl.searchParams.get('l')) {
      //если ссылка в ссылка redirectUrl корректная
      localStorage.setItem('redirectUrl', redirectUrl.href); // указываем точкой входа домен с протоколом из redirectUrl
    }
  }
  params.forEach(function (param) {
    if (url.searchParams.has(param)) localStorage.setItem(param, url.searchParams.get(param));
  });
  linkParams.forEach(function (linkParam) {
    if (url.searchParams.has(linkParam)) localStorage.setItem(linkParam, url.searchParams.get(linkParam));
  });
  window.addEventListener('click', function (e) {
    var link,
      parent = e.target.closest('a');
    if (parent.getAttribute('href') !== 'https://tds.favbet.partners') {
      return;
    }
    if (parent) {
      e.preventDefault();
      var affid = localStorage.getItem('affid');
      var cpaid = localStorage.getItem('cpaid');
      if (localStorage.getItem("redirectUrl")) {
        link = new URL(localStorage.getItem("redirectUrl"));
      } else {
        link = new URL(parent.href);
        if (affid && cpaid) {
          link.pathname = '/' + affid + '/' + cpaid;
        }
      }
      params.forEach(function (param) {
        if (url.searchParams.has(param)) {
          link.searchParams.set(param, localStorage.getItem(param));
        }
      });
      document.location.href = link;
    }
  });
})();
var popupFirstBtnTest = document.querySelector(".show-popup");
var popupFirstBtnClose = document.querySelector(".close-popup");
popupFirstBtnTest.addEventListener("click", function () {
  displayPopup(popupFirst);
  wrapper.style.pointerEvents = 'auto';
  overflow.style.overflow = 'hidden';
});
popupFirstBtnClose.addEventListener("click", function () {
  overlay.classList.add('opacity-overlay');
  popupFirst.classList.add('hide');
  overflow.style.overflow = 'auto';
});
"use strict";
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsicGxheUJ0biIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1haW4iLCJ3aGVlbCIsIm92ZXJsYXkiLCJwb3B1cEZpcnN0IiwicG9wdXBGaXJzdEJ0biIsInBvcHVwU2Vjb25kIiwib3ZlcmZsb3ciLCJ3cmFwcGVyIiwiY29weUJ0biIsImJvbnVzU3RhcnQiLCJib251c1RleHQiLCJhdWRpb0NvaW4iLCJhdWRpb0ZpcmV3b3JrIiwiYXVkaW9NYWluIiwiYXVkaW9XaGVlbCIsImJ0blZvbHVtZSIsImJ0blZvbHVtZUltZyIsImJvZHkiLCJ2b2x1bWUiLCJzY3JvbGxUb1RvcCIsImN1cnJlbnRQb3NpdGlvbiIsImRvY3VtZW50RWxlbWVudCIsInNjcm9sbFRvcCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInNjcm9sbFRvIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwiYWRkIiwicGxheSIsInNldEF0dHJpYnV0ZSIsInBhdXNlIiwiY3VycmVudFRpbWUiLCJzZXRUaW1lb3V0IiwidGV4dFRvQ29weSIsIm5hdmlnYXRvciIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJydW5GaXJzdFJvdGF0aW9uIiwic3R5bGUiLCJjdXJzb3IiLCJwb2ludGVyRXZlbnRzIiwiZG9BZnRlckZpcnN0Um90YXRpb24iLCJ0cmFuc2Zvcm0iLCJkaXNwbGF5UG9wdXAiLCJwb3B1cCIsImxvY2F0aW9uIiwicmVsb2FkIiwidXJsIiwiVVJMIiwiaHJlZiIsInBhcmFtcyIsImxpbmtQYXJhbXMiLCJzZWFyY2hQYXJhbXMiLCJoYXMiLCJyZWRpcmVjdFVybCIsImdldCIsIm1hdGNoIiwibGVuZ3RoIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsImZvckVhY2giLCJwYXJhbSIsImxpbmtQYXJhbSIsImUiLCJsaW5rIiwicGFyZW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsImdldEF0dHJpYnV0ZSIsInByZXZlbnREZWZhdWx0IiwiYWZmaWQiLCJnZXRJdGVtIiwiY3BhaWQiLCJwYXRobmFtZSIsInNldCIsInBvcHVwRmlyc3RCdG5UZXN0IiwicG9wdXBGaXJzdEJ0bkNsb3NlIl0sIm1hcHBpbmdzIjoiOztBQUNBLElBQU1BLE9BQU8sR0FBR0MsUUFBUSxDQUFDQyxhQUFhLENBQUMsd0JBQXdCLENBQUM7RUFDMURDLElBQUksR0FBR0YsUUFBUSxDQUFDQyxhQUFhLENBQUMsY0FBYyxDQUFDO0VBQzdDRSxLQUFLLEdBQUdILFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLHlCQUF5QixDQUFDO0VBQ3pERyxPQUFPLEdBQUdKLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLGlCQUFpQixDQUFDO0VBQ25ESSxVQUFVLEdBQUdMLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLGtCQUFrQixDQUFDO0VBQ3ZESyxhQUFhLEdBQUdOLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLHNCQUFzQixDQUFDO0VBQzlETSxXQUFXLEdBQUdQLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLG1CQUFtQixDQUFDO0VBQ3pETyxRQUFRLEdBQUdSLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLE1BQU0sQ0FBQztFQUN6Q1EsT0FBTyxHQUFHVCxRQUFRLENBQUNDLGFBQWEsQ0FBQyxRQUFRLENBQUM7RUFDMUNTLE9BQU8sR0FBR1YsUUFBUSxDQUFDQyxhQUFhLENBQUMsNEJBQTRCLENBQUM7RUFDOURVLFVBQVUsR0FBR1gsUUFBUSxDQUFDQyxhQUFhLENBQUMsZUFBZSxDQUFDO0VBQ3BEVyxTQUFTLEdBQUdaLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLGNBQWMsQ0FBQztFQUNsRFksU0FBUyxHQUFHYixRQUFRLENBQUNDLGFBQWEsQ0FBQyxjQUFjLENBQUM7RUFDbERhLGFBQWEsR0FBR2QsUUFBUSxDQUFDQyxhQUFhLENBQUMsaUJBQWlCLENBQUM7RUFDekRjLFNBQVMsR0FBR2YsUUFBUSxDQUFD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Q0FBQ3NCLEdBQUcsQ0FBQ2IsS0FBSyxFQUFFSCxZQUFZLENBQUNhLE9BQU8sQ0FBQ1YsS0FBSyxDQUFDLENBQUM7UUFDN0Q7TUFDSixDQUFDLENBQUM7TUFFRnRFLFFBQVEsQ0FBQ3NELFFBQVEsQ0FBQ0ksSUFBSSxHQUFHZSxJQUFJO0lBQ2pDO0VBQ0osQ0FBQyxDQUFDO0FBQ04sQ0FBQyxFQUFFLENBQUM7QUFFSixJQUFNVyxpQkFBaUIsR0FBR3BGLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLGFBQWEsQ0FBQztBQUMvRCxJQUFNb0Ysa0JBQWtCLEdBQUdyRixRQUFRLENBQUNDLGFBQWEsQ0FBQyxjQUFjLENBQUM7QUFFakVtRixpQkFBaUIsQ0FBQ3hELGdCQUFnQixDQUFDLE9BQU8sRUFBRSxZQUFLO0VBQzdDd0IsWUFBWSxDQUFDL0MsVUFBVSxDQUFDO0VBQ3hCSSxPQUFPLENBQUNzQyxLQUFLLENBQUNFLGFBQWEsR0FBRyxNQUFNO0VBQ3BDekMsUUFBUSxDQUFDdUMsS0FBSyxDQUFDdkMsUUFBUSxHQUFHLFFBQVE7QUFDdEMsQ0FBQyxDQUFDO0FBRUY2RSxrQkFBa0IsQ0FBQ3pELGdCQUFnQixDQUFDLE9BQU8sRUFBRSxZQUFLO0VBQzlDeEIsT0FBTyxDQUFDeUIsU0FBUyxDQUFDRyxHQUFHLENBQUMsaUJBQWlCLENBQUM7RUFDeEMzQixVQUFVLENBQUN3QixTQUFTLENBQUNHLEdBQUcsQ0FBQyxNQUFNLENBQUM7RUFDaEN4QixRQUFRLENBQUN1QyxLQUFLLENBQUN2QyxRQUFRLEdBQUcsTUFBTTtBQUNwQyxDQUFDLENBQUM7QUN4TUYiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fbWFpbi13aGVlbC1idG4nKSxcbiAgICAgIG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX21haW4nKSxcbiAgICAgIHdoZWVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19tYWluLXdoZWVsLXJlZWwnKSxcbiAgICAgIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX292ZXJsYXknKSxcbiAgICAgIHBvcHVwRmlyc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX2ZpcnN0V2luJyksXG4gICAgICBwb3B1cEZpcnN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19maXJzdFdpbi1idG4nKSxcbiAgICAgIHBvcHVwU2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19zZWNvbmRXaW4nKSxcbiAgICAgIG92ZXJmbG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgICAgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251cycpLFxuICAgICAgY29weUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fc2Vjb25kV2luLWNvZGUtYnRuJyksXG4gICAgICBib251c1N0YXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19zdGFydCcpLFxuICAgICAgYm9udXNUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX190ZXh0JyksXG4gICAgICBhdWRpb0NvaW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXVkaW8tY29pbnMnKSxcbiAgICAgIGF1ZGlvRmlyZXdvcmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXVkaW8tZmlyZXdvcmsnKSxcbiAgICAgIGF1ZGlvTWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdWRpby1tYWluJyksXG4gICAgICBhdWRpb1doZWVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF1ZGlvLXdoZWVsJyksXG4gICAgICBidG5Wb2x1bWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX211c2ljJyksXG4gICAgICBidG5Wb2x1bWVJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX211c2ljLWltZycpLFxuICAgICAgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuXG5hdWRpb01haW4udm9sdW1lID0gMC4zNVxuYXVkaW9GaXJld29yay52b2x1bWUgPSAwLjZcbmF1ZGlvQ29pbi52b2x1bWUgPSAwLjZcblxuZnVuY3Rpb24gc2Nyb2xsVG9Ub3AoKSB7XG4gICAgY29uc3QgY3VycmVudFBvc2l0aW9uID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDtcbiAgICBpZiAoY3VycmVudFBvc2l0aW9uID4gMCkge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNjcm9sbFRvVG9wKTtcbiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIGN1cnJlbnRQb3NpdGlvbiAtIGN1cnJlbnRQb3NpdGlvbiAvIDgpO1xuICAgIH1cbn1cblxuYnRuVm9sdW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGlmKGJ0blZvbHVtZS5jbGFzc0xpc3QuY29udGFpbnMoJ29mZicpKXtcbiAgICAgICAgYnRuVm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ29mZicpXG4gICAgICAgIGJ0blZvbHVtZS5jbGFzc0xpc3QuYWRkKCdvbicpXG4gICAgICAgIGF1ZGlvTWFpbi5wbGF5KClcbiAgICAgICAgYXVkaW9GaXJld29yay5wbGF5KClcbiAgICAgICAgYnRuVm9sdW1lSW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ltZy9zb3VuZC1vbi5zdmcnKVxuXG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnRuVm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ29uJylcbiAgICAgICAgYnRuVm9sdW1lLmNsYXNzTGlzdC5hZGQoJ29mZicpXG4gICAgICAgIGF1ZGlvTWFpbi5wYXVzZSgpXG4gICAgICAgIGF1ZGlvTWFpbi5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgIGF1ZGlvRmlyZXdvcmsucGF1c2UoKVxuICAgICAgICBhdWRpb0ZpcmV3b3JrLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgYXVkaW9XaGVlbC5wYXVzZSgpXG4gICAgICAgIGF1ZGlvV2hlZWwuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICBhdWRpb0NvaW4ucGF1c2UoKVxuICAgICAgICBhdWRpb0NvaW4uY3VycmVudFRpbWUgPSAwO1xuICAgICAgICBidG5Wb2x1bWVJbWcuc2V0QXR0cmlidXRlKCdzcmMnLCAnaW1nL3NvdW5kLW9mZi5zdmcnKVxuICAgIH1cbn0pXG5cbnNldFRpbWVvdXQoZnVuY3Rpb24gKCl7XG4gICAgYm9udXNTdGFydC5jbGFzc0xpc3QuYWRkKCdfYWN0aXZlJylcbiAgICBtYWluLmNsYXNzTGlzdC5hZGQoJ19hY3RpdmUnKVxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCl7XG4gICAgICAgIGJvbnVzVGV4dC5jbGFzc0xpc3QuYWRkKCdfdmlzaWJsZScpXG4gICAgfSwgMTIwMClcblxufSwgMzUwMCk7XG5cbmNvcHlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY29weUJ0bi5jbGFzc0xpc3QuYWRkKCdfY29weScpXG4gICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICBjb3B5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ19jb3B5JylcbiAgICB9LCAyMDAwKVxuICAgIGxldCB0ZXh0VG9Db3B5ID0gXCJlZ3lwdHNlbVwiO1xuICAgIC8vINCa0L7Qv9C40YDRg9C10Lwg0YLQtdC60YHRgiDQsiDQsdGD0YTQtdGAINC+0LHQvNC10L3QsFxuICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRleHRUb0NvcHkpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvcHkgY29kZScpXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignZXJyb3InLCBlcnJvcik7XG4gICAgICAgIH0pO1xufSlcblxucGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBydW5GaXJzdFJvdGF0aW9uKClcbn0pXG5cbmZ1bmN0aW9uIHJ1bkZpcnN0Um90YXRpb24oKSB7XG4gICAgc2Nyb2xsVG9Ub3AoKVxuICAgIGJ0blZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCdvZmYnKVxuICAgIGJ0blZvbHVtZS5jbGFzc0xpc3QuYWRkKCdvbicpXG4gICAgYnRuVm9sdW1lSW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ltZy9zb3VuZC1vbi5zdmcnKVxuICAgIGF1ZGlvTWFpbi5wbGF5KClcbiAgICBhdWRpb0ZpcmV3b3JrLnBsYXkoKVxuICAgIGF1ZGlvV2hlZWwucGxheSgpXG4gICAgd2hlZWwuY2xhc3NMaXN0LmFkZCgncmVlbC1yb3RhdGlvbi1maXJzdCcpXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdwdWxzZS1idG4nKVxuICAgIHBsYXlCdG4uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnXG4gICAgd3JhcHBlci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnXG4gICAgd3JhcHBlci5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nXG4gICAgYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGRvQWZ0ZXJGaXJzdFJvdGF0aW9uKClcbiAgICB9LCA2MDAwKVxufVxuXG5mdW5jdGlvbiBkb0FmdGVyRmlyc3RSb3RhdGlvbigpIHtcbiAgICBhdWRpb0NvaW4ucGxheSgpXG4gICAgd2hlZWwuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgxNDQwZGVnKSdcbiAgICB3aGVlbC5jbGFzc0xpc3QucmVtb3ZlKCdyZWVsLXJvdGF0aW9uLWZpcnN0JylcbiAgICBkaXNwbGF5UG9wdXAocG9wdXBGaXJzdClcbiAgICB3cmFwcGVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0bydcbiAgICBvdmVyZmxvdy5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nXG59XG5cblxucG9wdXBGaXJzdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBwb3B1cEZpcnN0LmNsYXNzTGlzdC5hZGQoJ19vcGFjaXR5JylcbiAgICBwb3B1cFNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdfb3BhY2l0eScpXG59KVxuXG5mdW5jdGlvbiBkaXNwbGF5UG9wdXAocG9wdXApIHtcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ29wYWNpdHktb3ZlcmxheScpXG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsICgpID0+IHtcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbn0pO1xuXG5cblxuXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHVybCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuICAgIHZhciBwYXJhbXMgPSBbJ2wnLCAndXRtX3NvdXJjZScsICd1dG1fbWVkaXVtJywgJ3V0bV9jYW1wYWlnbicsICd1dG1fdGVybScsICd1dG1fY29udGVudCcsICdwYXJhbTEnLCAncGFyYW0yJywgJ3BhcmFtMycsICdwYXJhbTQnLCAnY3JlYXRpdmVfdHlwZScsICdjcmVhdGl2ZV9pZCddO1xuICAgIHZhciBsaW5rUGFyYW1zID0gWydhZmZpZCcsICdjcGFpZCddOyAvLyDQuNGJ0LXQvCDQsiB1cmwgcmVkaXJlY3RVcmwg0LIgdXJsOlxuXG4gICAgaWYgKHVybC5zZWFyY2hQYXJhbXMuaGFzKCdyZWRpcmVjdFVybCcpKSB7XG4gICAgICAgIHZhciByZWRpcmVjdFVybCA9IG5ldyBVUkwodXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3JlZGlyZWN0VXJsJykpO1xuXG4gICAgICAgIGlmIChyZWRpcmVjdFVybC5ocmVmLm1hdGNoKC9cXC8vZykubGVuZ3RoID09PSA0ICYmIHJlZGlyZWN0VXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2wnKSkge1xuICAgICAgICAgICAgLy/QtdGB0LvQuCDRgdGB0YvQu9C60LAg0LIg0YHRgdGL0LvQutCwIHJlZGlyZWN0VXJsINC60L7RgNGA0LXQutGC0L3QsNGPXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVkaXJlY3RVcmwnLCByZWRpcmVjdFVybC5ocmVmKTsgLy8g0YPQutCw0LfRi9Cy0LDQtdC8INGC0L7Rh9C60L7QuSDQstGF0L7QtNCwINC00L7QvNC10L0g0YEg0L/RgNC+0YLQvtC60L7Qu9C+0Lwg0LjQtyByZWRpcmVjdFVybFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgIGlmICh1cmwuc2VhcmNoUGFyYW1zLmhhcyhwYXJhbSkpIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHBhcmFtLCB1cmwuc2VhcmNoUGFyYW1zLmdldChwYXJhbSkpO1xuICAgIH0pO1xuXG4gICAgbGlua1BhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rUGFyYW0pIHtcbiAgICAgICAgaWYgKHVybC5zZWFyY2hQYXJhbXMuaGFzKGxpbmtQYXJhbSkpIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGxpbmtQYXJhbSwgdXJsLnNlYXJjaFBhcmFtcy5nZXQobGlua1BhcmFtKSk7XG4gICAgfSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgbGluayxcbiAgICAgICAgICAgIHBhcmVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2EnKTtcblxuICAgICAgICBpZiAocGFyZW50LmdldEF0dHJpYnV0ZSgnaHJlZicpICE9PSAnaHR0cHM6Ly90ZHMuZmF2YmV0LnBhcnRuZXJzJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdmFyIGFmZmlkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FmZmlkJyk7XG4gICAgICAgICAgICB2YXIgY3BhaWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3BhaWQnKTtcblxuICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicmVkaXJlY3RVcmxcIikpIHtcbiAgICAgICAgICAgICAgICBsaW5rID0gbmV3IFVSTChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInJlZGlyZWN0VXJsXCIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGluayA9IG5ldyBVUkwocGFyZW50LmhyZWYpO1xuICAgICAgICAgICAgICAgIGlmIChhZmZpZCAmJiBjcGFpZCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLnBhdGhuYW1lID0gJy8nICsgYWZmaWQgKyAnLycgKyBjcGFpZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgICAgIGlmICh1cmwuc2VhcmNoUGFyYW1zLmhhcyhwYXJhbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGluay5zZWFyY2hQYXJhbXMuc2V0KHBhcmFtLCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShwYXJhbSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbi5ocmVmID0gbGluaztcbiAgICAgICAgfVxuICAgIH0pO1xufSkoKTtcblxuY29uc3QgcG9wdXBGaXJzdEJ0blRlc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNob3ctcG9wdXBcIik7XG5jb25zdCBwb3B1cEZpcnN0QnRuQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlLXBvcHVwXCIpO1xuXG5wb3B1cEZpcnN0QnRuVGVzdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgZGlzcGxheVBvcHVwKHBvcHVwRmlyc3QpXG4gICAgd3JhcHBlci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nXG4gICAgb3ZlcmZsb3cuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJ1xufSlcblxucG9wdXBGaXJzdEJ0bkNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ29wYWNpdHktb3ZlcmxheScpXG4gICAgcG9wdXBGaXJzdC5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICBvdmVyZmxvdy5zdHlsZS5vdmVyZmxvdyA9ICdhdXRvJ1xufSlcblxuXG4iLCIiXX0=
